# üåê Domain Setup Guide for sanbud24.pl (HitMe/SSL.pl)

This guide will help you configure your sanbud24.pl domain with your hosting provider and connect it to Azure.

## üìã Domain Credentials

**Domain Provider:** HitMe (ssl.hitme.net.pl)
**Domain:** sanbud24.pl
**Login Email:** sanbud.biuro@gmail.com
**Password:** MyszkaMiki1@

**Domain Panel URL:** https://ssl.hitme.net.pl/clientarea.php

---

## üöÄ Quick Start - Go Live in 6 Steps

### Step 1: Login to Domain Panel
```
URL: https://ssl.hitme.net.pl/clientarea.php
Email: sanbud.biuro@gmail.com
Password: MyszkaMiki1@
```

### Step 2: Deploy to Azure (One Command!)
```bash
cd /Users/haos/azure-san-bud
./deploy-azure-live.sh
```

This script will:
- ‚úÖ Create all Azure resources (PostgreSQL, App Service, Static Web Apps)
- ‚úÖ Configure environment variables
- ‚úÖ Generate deployment credentials
- ‚úÖ Provide you with DNS records to add

### Step 3: Configure DNS Records

After running the script, you'll get Azure endpoints. Login to your domain panel and add these DNS records:

#### A. Navigate to DNS Management
1. Go to https://ssl.hitme.net.pl/clientarea.php
2. Login with your credentials
3. Click on "Domains" ‚Üí "My Domains"
4. Click on "sanbud24.pl"
5. Click on "DNS Management" or "Manage DNS"

#### B. Add DNS Records

| Type | Host/Name | Points To / Value | TTL |
|------|-----------|------------------|-----|
| **CNAME** | @ | `swa-sanbud-frontend-prod.azurestaticapps.net` | 300 |
| **CNAME** | www | `swa-sanbud-frontend-prod.azurestaticapps.net` | 300 |
| **CNAME** | api | `app-sanbud-api-prod.azurewebsites.net` | 300 |
| **TXT** | @ | Azure validation token (from script output) | 300 |
| **TXT** | asuid.api | Backend verification ID (from script output) | 300 |
| **MX** | @ | mail.sanbud24.pl (Priority: 10) | 3600 |
| **TXT** | @ | `v=spf1 include:_spf.google.com ~all` | 3600 |

**Note:** The exact Azure endpoints will be provided by the deployment script output.

### Step 4: Add Custom Domains in Azure

After DNS records are added, run these commands:

```bash
# Add domains to Static Web App (Frontend)
az staticwebapp hostname set \
  --name swa-sanbud-frontend-prod \
  --resource-group rg-sanbud-prod \
  --hostname sanbud24.pl

az staticwebapp hostname set \
  --name swa-sanbud-frontend-prod \
  --resource-group rg-sanbud-prod \
  --hostname www.sanbud24.pl

# Add domain to App Service (Backend)
az webapp config hostname add \
  --webapp-name app-sanbud-api-prod \
  --resource-group rg-sanbud-prod \
  --hostname api.sanbud24.pl
```

### Step 5: Configure GitHub Secrets

Add these secrets to your GitHub repository for automated deployments:

**Go to:** https://github.com/kozuchowskihubert/azure-san-bud/settings/secrets/actions

Click "New repository secret" and add each of these:

1. **AZURE_WEBAPP_PUBLISH_PROFILE**
   - Value: Content from `azure-backend-publish-profile.xml` (generated by script)

2. **AZURE_STATIC_WEB_APPS_API_TOKEN**
   - Value: Token from script output

3. **DATABASE_URL**
   - Value: PostgreSQL connection string from script output

4. **SECRET_KEY**
   - Value: Secret key from script output

### Step 6: Deploy and Verify

```bash
# Push to trigger deployment
git push origin main

# Wait for deployment (2-5 minutes)
gh run watch

# Verify DNS propagation and deployment
./check-domain.sh
```

---

## üìù Detailed DNS Configuration Steps

### Option A: Using HitMe DNS Panel (Web Interface)

1. **Login to Domain Panel**
   ```
   URL: https://ssl.hitme.net.pl/clientarea.php
   Email: sanbud.biuro@gmail.com
   Password: MyszkaMiki1@
   ```

2. **Navigate to DNS Settings**
   - Click "Domains" in top menu
   - Click "My Domains"
   - Find "sanbud24.pl" and click "Manage"
   - Click "DNS Management" or "Advanced DNS"

3. **Delete Old Records (if any)**
   - Remove any existing A, CNAME records for @, www, api
   - Keep NS (nameserver) records - DO NOT DELETE

4. **Add New Records**
   
   **Root Domain (sanbud24.pl):**
   ```
   Type: CNAME
   Host: @ (or leave empty)
   Points To: swa-sanbud-frontend-prod.azurestaticapps.net
   TTL: 300 (5 minutes)
   ```
   
   **WWW Subdomain:**
   ```
   Type: CNAME
   Host: www
   Points To: swa-sanbud-frontend-prod.azurestaticapps.net
   TTL: 300
   ```
   
   **API Subdomain:**
   ```
   Type: CNAME
   Host: api
   Points To: app-sanbud-api-prod.azurewebsites.net
   TTL: 300
   ```
   
   **Azure Validation (Frontend):**
   ```
   Type: TXT
   Host: @
   Value: [Azure Static Web App validation token from script]
   TTL: 300
   ```
   
   **Azure Verification (Backend):**
   ```
   Type: TXT
   Host: asuid.api
   Value: [Backend verification ID from script]
   TTL: 300
   ```
   
   **Email SPF Record:**
   ```
   Type: TXT
   Host: @
   Value: v=spf1 include:_spf.google.com ~all
   TTL: 3600
   ```
   
   **Email MX Record:**
   ```
   Type: MX
   Host: @
   Points To: mail.sanbud24.pl
   Priority: 10
   TTL: 3600
   ```

5. **Save Changes**
   - Click "Save" or "Add Record" after each entry
   - Wait 5-10 minutes for propagation

### Option B: If HitMe Uses External DNS (Cloudflare, etc.)

If your domain uses Cloudflare or another DNS provider:

1. Check your nameservers:
   ```bash
   dig NS sanbud24.pl +short
   ```

2. If you see Cloudflare nameservers:
   - Login to Cloudflare: https://dash.cloudflare.com
   - Select sanbud24.pl domain
   - Go to "DNS" tab
   - Add the same records as above
   - **Important:** Set Proxy status to "DNS only" (grey cloud) for all records

3. If you see other nameservers, contact HitMe support for DNS management access

---

## üîç Verify DNS Configuration

### Check DNS Records
```bash
# Check root domain
dig sanbud24.pl +short

# Check www subdomain
dig www.sanbud24.pl +short

# Check API subdomain
dig api.sanbud24.pl +short

# Check TXT records
dig TXT sanbud24.pl +short
dig TXT asuid.api.sanbud24.pl +short

# Check MX records
dig MX sanbud24.pl +short
```

### Expected Results
```bash
# sanbud24.pl should point to:
swa-sanbud-frontend-prod.azurestaticapps.net

# www.sanbud24.pl should point to:
swa-sanbud-frontend-prod.azurestaticapps.net

# api.sanbud24.pl should point to:
app-sanbud-api-prod.azurewebsites.net
```

### Check DNS Propagation Globally
```bash
# From Google DNS
dig @8.8.8.8 sanbud24.pl +short

# From Cloudflare DNS
dig @1.1.1.1 sanbud24.pl +short

# From Quad9 DNS
dig @9.9.9.9 sanbud24.pl +short
```

### Online DNS Checkers
- https://dnschecker.org/#CNAME/sanbud24.pl
- https://www.whatsmydns.net/#CNAME/sanbud24.pl
- https://mxtoolbox.com/SuperTool.aspx?action=dns%3asanbud24.pl

---

## ‚è±Ô∏è DNS Propagation Timeline

| Level | Time | What's Happening |
|-------|------|------------------|
| **Local** | 5-10 minutes | Your ISP's DNS cache updates |
| **Regional** | 1-4 hours | DNS servers in Poland update |
| **Global** | 24-48 hours | All worldwide DNS servers update |

**Pro Tip:** Lower TTL values (300 seconds = 5 minutes) speed up propagation!

---

## üîí SSL Certificate Setup

Azure automatically provisions FREE SSL certificates!

### For Frontend (sanbud24.pl, www.sanbud24.pl)
- **Automatic:** Azure Static Web Apps auto-provisions SSL
- **Time:** 5-60 minutes after DNS validation
- **Certificate Type:** Let's Encrypt (free, auto-renewing)

### For Backend (api.sanbud24.pl)
- **Automatic:** Azure App Service auto-provisions SSL
- **Enable with:**
  ```bash
  az webapp config ssl bind \
    --name app-sanbud-api-prod \
    --resource-group rg-sanbud-prod \
    --certificate-name api.sanbud24.pl \
    --ssl-type SNI
  ```

### Check SSL Status
```bash
# Frontend SSL status
az staticwebapp show \
  --name swa-sanbud-frontend-prod \
  --resource-group rg-sanbud-prod \
  --query "customDomains[].{domain:name,status:status}" -o table

# Backend SSL status
az webapp config ssl list \
  --resource-group rg-sanbud-prod \
  --query "[?name=='api.sanbud24.pl']"

# Test HTTPS
curl -I https://sanbud24.pl
curl -I https://api.sanbud24.pl/api/health
```

### Verify SSL Certificate
```bash
# Check certificate details
openssl s_client -connect sanbud24.pl:443 -servername sanbud24.pl < /dev/null 2>/dev/null | openssl x509 -noout -dates -subject

# Test SSL rating (after site is live)
# Visit: https://www.ssllabs.com/ssltest/analyze.html?d=sanbud24.pl
```

---

## üéØ Complete Deployment Checklist

### Pre-Deployment
- [ ] Domain credentials verified (sanbud.biuro@gmail.com)
- [ ] Azure CLI installed (`az --version`)
- [ ] Logged into Azure (`az login`)
- [ ] Code committed to GitHub (`git status`)

### Deployment
- [ ] Run `./deploy-azure-live.sh`
- [ ] Note down all Azure endpoints
- [ ] Save database connection string
- [ ] Save deployment tokens

### DNS Configuration
- [ ] Login to ssl.hitme.net.pl
- [ ] Add CNAME record for @ (root)
- [ ] Add CNAME record for www
- [ ] Add CNAME record for api
- [ ] Add TXT record for Azure validation
- [ ] Add TXT record for backend verification
- [ ] Add MX record for email
- [ ] Add TXT record for SPF
- [ ] Verify DNS with `dig` commands

### Azure Custom Domains
- [ ] Add sanbud24.pl to Static Web App
- [ ] Add www.sanbud24.pl to Static Web App
- [ ] Add api.sanbud24.pl to App Service
- [ ] Wait for SSL certificate provisioning (5-60 min)

### GitHub Configuration
- [ ] Add AZURE_WEBAPP_PUBLISH_PROFILE secret
- [ ] Add AZURE_STATIC_WEB_APPS_API_TOKEN secret
- [ ] Add DATABASE_URL secret
- [ ] Add SECRET_KEY secret
- [ ] Push to main branch (`git push origin main`)
- [ ] Watch deployment (`gh run watch`)

### Database Initialization
- [ ] SSH into backend: `az webapp ssh --name app-sanbud-api-prod --resource-group rg-sanbud-prod`
- [ ] Run: `python init_db.py`
- [ ] Run: `python init_admin.py`
- [ ] Exit SSH

### Verification
- [ ] Run `./check-domain.sh`
- [ ] Visit https://sanbud24.pl (homepage loads)
- [ ] Visit https://www.sanbud24.pl (redirects to non-www)
- [ ] Test API: `curl https://api.sanbud24.pl/api/health`
- [ ] Login to admin panel: https://sanbud24.pl/admin/login
- [ ] Test contact form submission
- [ ] Test service booking
- [ ] Check SSL certificate (green padlock)
- [ ] Test on mobile devices
- [ ] Test language switcher (PL/EN)

### Post-Deployment
- [ ] Change admin password from default
- [ ] Enable Application Insights monitoring
- [ ] Configure backup schedule
- [ ] Add firewall rules (if needed)
- [ ] Set up uptime monitoring (e.g., UptimeRobot)
- [ ] Add Google Analytics (optional)
- [ ] Submit sitemap to Google Search Console
- [ ] Test email functionality

---

## üÜò Troubleshooting

### Problem: Cannot login to ssl.hitme.net.pl

**Solution:**
```bash
# Try password reset
# Visit: https://ssl.hitme.net.pl/pwreset.php
# Use email: sanbud.biuro@gmail.com

# Or contact HitMe support
# Email: support@hitme.net.pl
# Phone: Check their website
```

### Problem: CNAME not working for root domain

Some DNS providers don't support CNAME for root domain (@).

**Solution A: Use ALIAS record (if supported)**
```
Type: ALIAS
Host: @
Points To: swa-sanbud-frontend-prod.azurestaticapps.net
```

**Solution B: Use Azure Front Door**
```bash
# Create Front Door (provides A record)
az afd profile create \
  --profile-name fd-sanbud-prod \
  --resource-group rg-sanbud-prod \
  --sku Standard_AzureFrontDoor

# Get A record IP
az afd endpoint show \
  --endpoint-name sanbud24 \
  --profile-name fd-sanbud-prod \
  --resource-group rg-sanbud-prod
```

**Solution C: Use www as primary**
```
# Make www.sanbud24.pl the primary domain
# Redirect @ to www
```

### Problem: DNS not propagating

**Check:**
```bash
# 1. Verify records are saved in DNS panel
# Login to ssl.hitme.net.pl and check

# 2. Check nameservers
dig NS sanbud24.pl +short

# 3. Query nameservers directly
dig @ns1.hitme.net.pl sanbud24.pl

# 4. Clear local DNS cache
sudo dscacheutil -flushcache
sudo killall -HUP mDNSResponder

# 5. Wait more time (can take 24-48 hours)
```

### Problem: SSL certificate not provisioning

**Check:**
```bash
# 1. Verify DNS is propagating
dig sanbud24.pl +short

# 2. Check custom domain status
az staticwebapp show \
  --name swa-sanbud-frontend-prod \
  --resource-group rg-sanbud-prod \
  --query "customDomains"

# 3. Wait longer (can take up to 60 minutes)

# 4. Remove and re-add domain
az staticwebapp hostname delete \
  --name swa-sanbud-frontend-prod \
  --resource-group rg-sanbud-prod \
  --hostname sanbud24.pl

# Wait 5 minutes, then add again
az staticwebapp hostname set \
  --name swa-sanbud-frontend-prod \
  --resource-group rg-sanbud-prod \
  --hostname sanbud24.pl
```

### Problem: API not responding

**Check:**
```bash
# 1. Check backend logs
az webapp log tail \
  --name app-sanbud-api-prod \
  --resource-group rg-sanbud-prod

# 2. Restart backend
az webapp restart \
  --name app-sanbud-api-prod \
  --resource-group rg-sanbud-prod

# 3. Check environment variables
az webapp config appsettings list \
  --name app-sanbud-api-prod \
  --resource-group rg-sanbud-prod

# 4. SSH into backend and test
az webapp ssh \
  --name app-sanbud-api-prod \
  --resource-group rg-sanbud-prod
```

---

## üìû Support Contacts

### Domain Provider (HitMe)
- **Website:** https://www.hitme.net.pl
- **Support:** support@hitme.net.pl
- **Panel:** https://ssl.hitme.net.pl/clientarea.php

### Azure Support
- **Portal:** https://portal.azure.com
- **Documentation:** https://docs.microsoft.com/azure
- **Support:** Create ticket in Azure Portal

### Project Repository
- **GitHub:** https://github.com/kozuchowskihubert/azure-san-bud
- **Issues:** https://github.com/kozuchowskihubert/azure-san-bud/issues

---

## üéâ Ready to Go Live!

**Execute these commands in order:**

```bash
# 1. Deploy to Azure (creates all resources)
cd /Users/haos/azure-san-bud
./deploy-azure-live.sh

# 2. Configure DNS (use credentials above)
# Login to https://ssl.hitme.net.pl/clientarea.php
# Add the DNS records shown in script output

# 3. Add custom domains in Azure
# Run the commands provided by the script

# 4. Configure GitHub secrets
# Add secrets from script output to GitHub

# 5. Deploy code
git push origin main
gh run watch

# 6. Initialize database
az webapp ssh --name app-sanbud-api-prod --resource-group rg-sanbud-prod
python init_db.py && python init_admin.py
exit

# 7. Verify everything
./check-domain.sh
```

**Your site will be live at:**
- üåê **https://sanbud24.pl** - Main website
- üîß **https://api.sanbud24.pl** - API backend
- üë§ **https://sanbud24.pl/admin** - Admin panel

**Default admin credentials:**
- Username: `admin`
- Password: `admin123`
- ‚ö†Ô∏è **CHANGE THIS IMMEDIATELY AFTER FIRST LOGIN!**

---

**Good luck with your deployment! üöÄ**
